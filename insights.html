<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insights - Threads</title>
    <link rel="stylesheet" href="profile.css">
    <link rel="stylesheet" href="sidebar.css">
    <style>
        .insights-header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px 20px;
            position: relative;
            width: 100%;
            max-width: 600px;
            box-sizing: border-box;
        }

        .insights-header-title {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .insights-header-title span:first-child {
            font-size: 16px;
            font-weight: 700;
        }

        .insights-header-title .insights-header-date {
            font-size: 12px;
            font-weight: 400;
            color: rgb(153, 153, 153);
            line-height: 16.8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
        }

        .insights-header-dropdown {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .insights-dropdown-circle {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: rgb(255, 255, 255);
            border: 0.5px solid rgba(0, 0, 0, 0.15);
            box-shadow: rgba(0, 0, 0, 0.08) 0px 2px 8px 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .insights-dropdown-circle:hover {
            transform: scale(1.05);
        }

        .insights-dropdown-circle svg {
            color: #000000;
        }

        [data-theme="dark"] .insights-dropdown-circle {
            background-color: rgb(38, 38, 38);
            border-color: rgba(255, 255, 255, 0.15);
        }

        [data-theme="dark"] .insights-dropdown-circle svg {
            color: #f5f5f5;
        }

        .date-range-container {
            position: relative;
        }

        .date-range-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 12px;
            background-color: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15);
            min-width: 200px;
            padding: 8px;
            z-index: 2000;
        }

        .date-range-dropdown.active {
            display: block;
        }

        .date-range-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 16px;
            background: none;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            color: #000000;
            text-align: left;
        }

        .date-range-item:hover {
            background-color: #f5f5f5;
        }

        .date-range-check {
            display: none;
            color: #000000;
        }

        .date-range-item.active .date-range-check {
            display: block;
        }

        [data-theme="dark"] .date-range-dropdown {
            background-color: #262626;
        }

        [data-theme="dark"] .date-range-item {
            color: #f5f5f5;
        }

        [data-theme="dark"] .date-range-item:hover {
            background-color: #333;
        }

        [data-theme="dark"] .date-range-check {
            color: #f5f5f5;
        }

        .insights-menu-container {
            position: absolute;
            right: 20px;
        }

        .insights-menu {
            background-color: rgb(255, 255, 255);
            border: 0.5px solid rgba(0, 0, 0, 0.15);
            border-radius: 50%;
            cursor: pointer;
            color: #000000;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: width 0.15s ease, height 0.15s ease;
        }

        .insights-menu:hover {
            width: 28px;
            height: 28px;
        }

        [data-theme="dark"] .insights-menu {
            background-color: rgb(38, 38, 38);
            border-color: rgba(255, 255, 255, 0.15);
            color: #f5f5f5;
        }

        .insights-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background-color: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15);
            min-width: 200px;
            padding: 8px;
            z-index: 2000;
        }

        .insights-dropdown.active {
            display: block;
        }

        .insights-dropdown-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 14px 16px;
            background: none;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            color: #000000;
            text-align: left;
        }

        .insights-dropdown-item:hover {
            background-color: #f5f5f5;
        }

        [data-theme="dark"] .insights-dropdown {
            background-color: #262626;
        }

        [data-theme="dark"] .insights-dropdown-item {
            color: #f5f5f5;
        }

        [data-theme="dark"] .insights-dropdown-item:hover {
            background-color: #333;
        }

        [data-theme="dark"] .insights-banner {
            background-color: #181818;
            border-color: rgba(255, 255, 255, 0.15);
        }

        [data-theme="dark"] .insights-header-title span:first-child {
            color: #f5f5f5;
        }

        .insights-content {
            width: 100%;
            max-width: 600px;
        }

        .insights-banner {
            background-color: #ffffff;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .insights-banner-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .insights-banner-text {
            font-size: 15px;
            color: #999999;
        }

        .insights-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 100px 20px;
            text-align: center;
        }

        .insights-empty-icon {
            color: #999999;
            margin-bottom: 20px;
        }

        .insights-empty-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .insights-empty-text {
            font-size: 15px;
            color: #999999;
        }

        [data-theme="dark"] .insights-header-title span:first-child {
            color: #f5f5f5;
        }

        [data-theme="dark"] .date-range-item {
            color: #f5f5f5;
        }

        [data-theme="dark"] .date-range-item:hover {
            background-color: #333;
        }

        [data-theme="dark"] .date-range-check {
            color: #f5f5f5;
        }

        [data-theme="dark"] .insights-menu {
            color: #f5f5f5;
        }

        [data-theme="dark"] .insights-dropdown-item {
            color: #f5f5f5;
        }

        [data-theme="dark"] .insights-dropdown-item:hover {
            background-color: #333;
        }

        [data-theme="dark"] .insights-banner {
            background-color: #181818;
            border-color: rgba(255, 255, 255, 0.15);
        }

        [data-theme="dark"] .insights-banner-title {
            color: #f5f5f5;
        }

        [data-theme="dark"] .insights-empty-title {
            color: #f5f5f5;
        }

        @media (max-width: 700px) {
            body, .main-content, .app {
                background-color: #fff !important;
            }

            [data-theme="dark"] body,
            [data-theme="dark"] .main-content,
            [data-theme="dark"] .app {
                background-color: #101010 !important;
            }

            .insights-header {
                justify-content: flex-start;
                padding: 0 16px 12px;
            }

            .insights-header-title span:first-child {
                font-size: 26px;
                font-weight: 800;
            }

            .insights-header-dropdown {
                gap: 6px;
            }

            .insights-header-date {
                display: none;
            }

            .insights-dropdown-circle {
                display: none;
            }

            .insights-menu-container {
                display: none;
            }

            .insights-content {
                padding: 0 16px;
            }

            .insights-empty {
                padding: 60px 20px;
            }

            .insights-empty-title {
                font-size: 18px;
            }

            .insights-empty-text {
                font-size: 14px;
            }

            .insights-banner {
                padding: 16px;
                margin-bottom: 16px;
            }
        }
    </style>
    <script>
        (function() {
            let raw = localStorage.getItem('threads_theme');
            let savedTheme = 'auto';
            if (raw) savedTheme = JSON.parse(raw);
            if (savedTheme == 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
            } else if (savedTheme == 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                if (!window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.setAttribute('data-theme', 'light');
                } else {
                    document.documentElement.setAttribute('data-theme', 'dark');
                }
            }
        })();
    </script>
</head>
<body>
    <div class="app">
        <!-- Left Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-top">
                <a href="index.html" class="logo-link">
                    <img src="icons/logo.svg" width="30" height="34" alt="Threads" class="logo">
                </a>
            </div>

            <div class="sidebar-menu">
                <button class="nav-btn" data-tab="home" title="Home">
                    <img src="icons/home.svg" width="26" height="26" alt="Home">
                </button>
                <button class="nav-btn" data-tab="search" title="Search">
                    <img src="icons/search.svg" width="26" height="26" alt="Search">
                </button>
                <button class="nav-btn" data-tab="create" title="Create">
                    <img src="icons/create.svg" width="26" height="26" alt="Create">
                </button>
                <button class="nav-btn" data-tab="activity" title="Activity">
                    <img src="icons/heart.svg" width="26" height="26" alt="Activity">
                </button>
                <button class="nav-btn" data-tab="profile" title="Profile">
                    <img src="icons/profile.svg" width="26" height="26" alt="Profile">
                </button>
            </div>

            <div class="sidebar-bottom">
                <button class="nav-btn" id="pinBtn" title="Pin">
                    <img src="icons/pin.svg" width="26" height="26" alt="Pin">
                </button>
                <div class="menu-btn-container">
                    <button class="nav-btn" id="menuBtn" title="Menu">
                        <img src="icons/menu.svg" width="26" height="26" alt="Menu">
                    </button>
                    <div class="menu-dropdown" id="menuDropdown">
                        <!-- Main Menu -->
                        <div class="menu-main" id="menuMain">
                            <div class="menu-section">
                                <button class="menu-item has-arrow" id="appearanceBtn">
                                    Appearance
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="9 18 15 12 9 6"/>
                                    </svg>
                                </button>
                                <button class="menu-item">Insights</button>
                                <button class="menu-item">Settings</button>
                            </div>
                            <div class="menu-divider"></div>
                            <div class="menu-section">
                                <button class="menu-item has-arrow" id="menuFeedsBtn">
                                    Feeds
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="9 18 15 12 9 6"/>
                                    </svg>
                                </button>
                                <button class="menu-item">Saved</button>
                                <button class="menu-item">Liked</button>
                            </div>
                            <div class="menu-divider"></div>
                            <div class="menu-section">
                                <button class="menu-item">Report a problem</button>
                                <button class="menu-item logout" id="logoutBtn">Log out</button>
                            </div>
                        </div>
                        <!-- Appearance Submenu -->
                        <div class="menu-submenu" id="menuAppearanceSubmenu">
                            <div class="submenu-header">
                                <button class="submenu-back" id="appearanceBackBtn">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="15 18 9 12 15 6"/>
                                    </svg>
                                </button>
                                <span class="submenu-title">Appearance</span>
                                <div class="submenu-spacer"></div>
                            </div>
                            <div class="appearance-options">
                                <button class="appearance-option active" data-theme="light">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="12" cy="12" r="4"/>
                                        <line x1="12" y1="2" x2="12" y2="4"/>
                                        <line x1="12" y1="20" x2="12" y2="22"/>
                                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                                        <line x1="2" y1="12" x2="4" y2="12"/>
                                        <line x1="20" y1="12" x2="22" y2="12"/>
                                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                                    </svg>
                                </button>
                                <button class="appearance-option" data-theme="dark">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                                    </svg>
                                </button>
                                <button class="appearance-option" data-theme="auto">
                                    Auto
                                </button>
                            </div>
                        </div>
                        <!-- Feeds Submenu -->
                        <div class="menu-submenu" id="menuFeedsSubmenu">
                            <div class="submenu-header">
                                <button class="submenu-back" id="menuFeedsBackBtn">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="15 18 9 12 15 6"/>
                                    </svg>
                                </button>
                                <span class="submenu-title">Feeds</span>
                                <button class="submenu-add">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="10" cy="10" r="7.5"/>
                                        <line x1="10" y1="6.5" x2="10" y2="13.5"/>
                                        <line x1="6.5" y1="10" x2="13.5" y2="10"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="menu-feeds-list">
                                <button class="menu-item" data-feed="foryou">For you</button>
                                <button class="menu-item" data-feed="following">Following</button>
                                <button class="menu-item" data-feed="ghost">
                                    Ghost posts
                                    <svg width="20" height="20" viewBox="0 0 20 19" fill="currentColor">
                                        <path d="M4.60249 16.4045C4.86284 16.0252 5.38193 15.9287 5.76134 16.1888C6.1495 16.4552 6.56424 16.6861 6.99995 16.8765C7.4757 17.0843 7.97782 17.2443 8.49897 17.3501C8.94984 17.4417 9.24062 17.8823 9.1492 18.3332C9.0575 18.784 8.61788 19.0757 8.16694 18.9842C7.52911 18.8547 6.9149 18.6584 6.33263 18.404C5.79943 18.171 5.29237 17.8888 4.81814 17.5633C4.43901 17.3028 4.34214 16.7838 4.60249 16.4045Z"></path>
                                        <path d="M14.2379 16.1888C14.6172 15.9285 15.1362 16.0253 15.3968 16.4045C15.6572 16.7839 15.5606 17.3029 15.1811 17.5633C14.7068 17.8888 14.1999 18.171 13.6666 18.404C13.0843 18.6584 12.4702 18.8547 11.8323 18.9842C11.3814 19.0756 10.9408 18.784 10.8492 18.3332C10.7579 17.8824 11.0496 17.4418 11.5003 17.3501C12.0215 17.2443 12.5235 17.0843 12.9993 16.8765C13.4351 16.686 13.8497 16.4553 14.2379 16.1888Z"></path>
                                        <path d="M1.6671 10.8503C2.11797 10.7587 2.55758 11.0506 2.64936 11.5013C2.75515 12.0225 2.91515 12.5246 3.12299 13.0003C3.31653 13.4433 3.55247 13.8647 3.82449 14.2585C4.08586 14.6371 3.99064 15.1558 3.61209 15.4173C3.23352 15.6786 2.71482 15.5841 2.45323 15.2057C2.12096 14.7248 1.83313 14.2096 1.5963 13.6676C1.34194 13.0854 1.14555 12.4711 1.01606 11.8333C0.924746 11.3825 1.21638 10.942 1.6671 10.8503Z"></path>
                                        <path d="M9.99962 0.833984C15.0621 0.833995 19.1661 4.93817 19.1663 10.0007C19.1663 10.6273 19.1035 11.2407 18.9832 11.8333C18.8537 12.4712 18.6574 13.0853 18.4029 13.6676C18.1661 14.2098 17.8784 14.7247 17.546 15.2057C17.2844 15.5842 16.7657 15.6787 16.3872 15.4173C16.0089 15.1557 15.9135 14.637 16.1748 14.2585C16.4469 13.8646 16.6827 13.4434 16.8762 13.0003C17.0841 12.5245 17.2441 12.0226 17.3499 11.5013C17.4481 11.0172 17.4996 10.5153 17.4996 10.0007C17.4995 5.85864 14.1417 2.50066 9.99962 2.50065C8.8214 2.50071 7.70832 2.77171 6.71837 3.25423L6.5963 3.30225C6.4708 3.34043 6.33684 3.34834 6.20649 3.32503L2.70307 2.69922L3.33865 6.17334C3.3709 6.34936 3.34609 6.53119 3.26704 6.69173C2.93406 7.3678 2.69972 8.10131 2.58344 8.87354C2.51495 9.32865 2.09048 9.64271 1.63536 9.57422C1.18062 9.50551 0.867211 9.08097 0.935494 8.62614C1.06319 7.77778 1.30818 6.96719 1.65164 6.21159L0.846789 1.81706C0.797783 1.54853 0.882883 1.27241 1.07547 1.07894C1.26812 0.885461 1.54399 0.799138 1.81277 0.847005L6.24148 1.63883C7.38929 1.12218 8.66189 0.834039 9.99962 0.833984Z"></path>
                                        <path d="M13.1572 10.974C13.4826 10.6486 14.0101 10.6485 14.3356 10.974C14.6608 11.2994 14.6609 11.8269 14.3356 12.1523C13.7273 12.7606 12.87 13.0214 12.0797 13.0215C11.2894 13.0215 10.4321 12.7606 9.82384 12.1523C9.4984 11.8269 9.4984 11.2994 9.82384 10.974C10.1493 10.6486 10.6768 10.6485 11.0022 10.974C11.2273 11.1989 11.6202 11.3548 12.0797 11.3548C12.5392 11.3548 12.9322 11.1989 13.1572 10.974Z"></path>
                                        <path d="M14.7913 7.81966C15.3664 7.82039 15.8318 8.28705 15.8313 8.86214C15.8306 9.43723 15.364 9.90285 14.7888 9.90218C14.2137 9.9016 13.7482 9.43482 13.7488 8.8597C13.7494 8.28458 14.2162 7.8191 14.7913 7.81966Z"></path>
                                        <path d="M9.37543 7.81315C9.95079 7.81371 10.4169 8.28038 10.4163 8.85563C10.4157 9.43071 9.94895 9.89624 9.37381 9.89567C8.79875 9.89509 8.33245 9.42827 8.33295 8.85319C8.33372 8.27828 8.80075 7.81275 9.37543 7.81315Z"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Mobile Top Bar -->
        <div class="mobile-top-bar">
            <div class="mobile-top-spacer"></div>
            <a href="index.html" class="mobile-top-logo">
                <img src="icons/logo.svg" width="28" height="32" alt="Threads">
            </a>
            <div class="mobile-menu-container">
                <button class="mobile-top-menu" id="mobileMenuBtn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <rect rx="1.25" x="3" y="7" width="18" height="2.5"></rect>
                        <rect rx="1.25" x="10" y="15" width="11" height="2.5"></rect>
                    </svg>
                </button>
                <div class="menu-dropdown" id="mobileMenuDropdown">
                    <div class="menu-main" id="mobileMenuMain">
                        <div class="menu-section">
                            <button class="menu-item has-arrow" id="mobileAppearanceBtn">
                                Appearance
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </button>
                            <button class="menu-item">Insights</button>
                            <button class="menu-item">Settings</button>
                        </div>
                        <div class="menu-divider"></div>
                        <div class="menu-section">
                            <button class="menu-item has-arrow" id="mobileFeedsBtn">
                                Feeds
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </button>
                            <button class="menu-item">Saved</button>
                            <button class="menu-item">Liked</button>
                        </div>
                        <div class="menu-divider"></div>
                        <div class="menu-section">
                            <button class="menu-item">Report a problem</button>
                            <button class="menu-item logout" id="mobileLogoutBtn">Log out</button>
                        </div>
                    </div>
                    <!-- Appearance Submenu -->
                    <div class="menu-submenu" id="mobileAppearanceSubmenu">
                        <div class="submenu-header">
                            <button class="submenu-back" id="mobileAppearanceBackBtn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="15 18 9 12 15 6"></polyline>
                                </svg>
                            </button>
                            <span class="submenu-title">Appearance</span>
                            <div class="submenu-spacer"></div>
                        </div>
                        <div class="appearance-options">
                            <button class="appearance-option active" data-theme="light">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <circle cx="12" cy="12" r="4"></circle>
                                    <line x1="12" y1="2" x2="12" y2="4"></line>
                                    <line x1="12" y1="20" x2="12" y2="22"></line>
                                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                    <line x1="2" y1="12" x2="4" y2="12"></line>
                                    <line x1="20" y1="12" x2="22" y2="12"></line>
                                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                </svg>
                            </button>
                            <button class="appearance-option" data-theme="dark">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                                </svg>
                            </button>
                            <button class="appearance-option" data-theme="auto">
                                Auto
                            </button>
                        </div>
                    </div>
                    <!-- Feeds Submenu -->
                    <div class="menu-submenu" id="mobileFeedsSubmenu">
                        <div class="submenu-header">
                            <button class="submenu-back" id="mobileFeedsBackBtn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="15 18 9 12 15 6"></polyline>
                                </svg>
                            </button>
                            <span class="submenu-title">Feeds</span>
                            <button class="submenu-add">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <circle cx="10" cy="10" r="7.5"></circle>
                                    <line x1="10" y1="6.5" x2="10" y2="13.5"></line>
                                    <line x1="6.5" y1="10" x2="13.5" y2="10"></line>
                                </svg>
                            </button>
                        </div>
                        <div class="menu-feeds-list">
                            <button class="menu-item" data-feed="foryou">For you</button>
                            <button class="menu-item" data-feed="following">Following</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Insights Header -->
            <div class="insights-header">
                <div class="insights-header-dropdown">
                    <div class="insights-header-title">
                        <span>Insights</span>
                        <span class="insights-header-date" id="insightsHeaderDate"></span>
                    </div>
                    <div class="date-range-container">
                        <div class="insights-dropdown-circle" id="dateRangeBtn">
                            <svg aria-label="Date range" role="img" viewBox="0 0 13 12" width="12" height="12">
                                <path d="m2.5 4.2 4 4 4-4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                            </svg>
                        </div>
                        <div class="date-range-dropdown" id="dateRangeDropdown">
                            <button class="date-range-item" data-days="7">
                                <span>Last 7 days</span>
                                <svg class="date-range-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="21.648 5.352 9.002 17.998 2.358 11.358"></polyline>
                                </svg>
                            </button>
                            <button class="date-range-item" data-days="14">
                                <span>Last 14 days</span>
                                <svg class="date-range-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="21.648 5.352 9.002 17.998 2.358 11.358"></polyline>
                                </svg>
                            </button>
                            <button class="date-range-item active" data-days="30">
                                <span>Last 30 days</span>
                                <svg class="date-range-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="21.648 5.352 9.002 17.998 2.358 11.358"></polyline>
                                </svg>
                            </button>
                            <button class="date-range-item" data-days="90">
                                <span>Last 90 days</span>
                                <svg class="date-range-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="21.648 5.352 9.002 17.998 2.358 11.358"></polyline>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="insights-menu-container">
                    <button class="insights-menu" id="insightsMenuBtn">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="1.5"/>
                            <circle cx="4" cy="12" r="1.5"/>
                            <circle cx="20" cy="12" r="1.5"/>
                        </svg>
                    </button>
                    <div class="insights-dropdown" id="insightsDropdown">
                        <button class="insights-dropdown-item">
                            <span>Add as column</span>
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M3 2C2.58579 2 2.25 2.33579 2.25 2.75V4.25H0.75C0.335786 4.25 0 4.58579 0 5C0 5.41421 0.335786 5.75 0.75 5.75H2.25V7.25C2.25 7.66421 2.58579 8 3 8C3.41421 8 3.75 7.66421 3.75 7.25V5.75H5.25C5.66421 5.75 6 5.41421 6 5C6 4.58579 5.66421 4.25 5.25 4.25H3.75V2.75C3.75 2.33579 3.41421 2 3 2Z"></path>
                                <path clip-rule="evenodd" d="M7.25 3.75H16C17.5188 3.75 18.75 4.98122 18.75 6.5V14.5C18.75 16.0188 17.5188 17.25 16 17.25H5C3.48122 17.25 2.25 16.0188 2.25 14.5V9.5H3.75V14.5C3.75 15.1904 4.30964 15.75 5 15.75H7.25V3.75ZM8.75 15.75V5.25H12.25V15.75H8.75ZM13.75 15.75H16C16.6904 15.75 17.25 15.1904 17.25 14.5V6.5C17.25 5.80964 16.6904 5.25 16 5.25H13.75V15.75Z" fill-rule="evenodd"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="insights-content">
                <!-- Weekly Recap Banner -->
                <div class="insights-banner">
                    <div class="insights-banner-title">Your weekly recap is ready!</div>
                    <div class="insights-banner-text">See how things went last week.</div>
                </div>

                <!-- Empty State -->
                <div class="insights-empty">
                    <svg class="insights-empty-icon" viewBox="0 0 24 24" fill="currentColor" width="66" height="66">
                        <rect fill="none" height="20" rx="5" stroke="currentColor" stroke-width="2" width="20" x="2" y="2"></rect>
                        <rect height="12" rx="1" width="2" x="11" y="6"></rect>
                        <rect height="9" rx="1" width="2" x="15" y="9"></rect>
                        <rect height="5" rx="1" width="2" x="7" y="13"></rect>
                    </svg>
                    <div class="insights-empty-title">Insights await</div>
                    <div class="insights-empty-text">Check back in once you've reached 100 followers to see your insights.</div>
                </div>
            </div>
        </main>

        <!-- FAB -->
        <button class="fab" id="fab">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        </button>
    </div>

    <!-- Create Post Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-content create-post-modal" id="createPostForm">
                <div class="create-post-header">
                    <button class="create-post-close" id="createPostClose">
                        <svg aria-label="Close" role="img" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                            <path d="M19.707 5.707a1 1 0 0 0-1.414-1.414L12 10.586 5.707 4.293a1 1 0 0 0-1.414 1.414L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 0 0 1.414-1.414L13.414 12l6.293-6.293Z"/>
                        </svg>
                    </button>
                    <h2>New thread</h2>
                    <div class="create-post-header-icons">
                        <button class="header-icon-btn" id="draftsBtn" title="Drafts">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <rect height="15" rx="4.5" stroke="currentColor" stroke-width="2" width="15" x="7" y="7" fill="none"></rect>
                                <path clip-rule="evenodd" d="M15.3833 4.50007C15.0018 4.15977 14.5475 3.9045 14.05 3.75672C13.7983 3.68195 13.432 3.6357 12.7078 3.68313C11.9633 3.73189 11.0102 3.86454 9.59538 4.06338C8.18054 4.26222 7.22784 4.39741 6.4987 4.55577C5.78946 4.7098 5.45011 4.85522 5.22879 4.99646C4.51904 5.44941 3.99637 6.14302 3.7566 6.95012C3.68183 7.2018 3.63558 7.56809 3.68301 8.29232C3.73177 9.03686 3.86442 9.98992 4.06326 11.4047C4.23845 12.6513 4.36423 13.5391 4.49997 14.2313V17.5001C4.49997 17.737 4.51175 17.9713 4.53475 18.2022C4.05772 17.8249 3.64282 17.3681 3.31041 16.8473C2.66675 15.8387 2.47208 14.4535 2.08272 11.6831C1.69337 8.91269 1.49869 7.52748 1.83941 6.38057C2.21619 5.11227 3.03754 4.02231 4.15285 3.31053C5.16142 2.66688 6.54662 2.4722 9.31703 2.08284C12.0874 1.69349 13.4726 1.49881 14.6196 1.83953C15.8878 2.21631 16.9778 3.03766 17.6896 4.15297C17.7623 4.26696 17.8294 4.38577 17.8916 4.51084C17.7619 4.50369 17.6314 4.50007 17.5 4.50007H15.3833Z" fill-rule="evenodd"></path>
                                <rect height="2" rx="1" width="9" x="10" y="12"></rect>
                                <rect height="2" rx="1" width="6" x="10" y="15"></rect>
                            </svg>
                        </button>
                        <div class="more-menu-container">
                            <button class="header-icon-btn" id="moreMenuBtn" title="More">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M7.5 13.5C6.67157 13.5 6 12.8284 6 12C6 11.1716 6.67157 10.5 7.5 10.5C8.32843 10.5 9 11.1716 9 12C9 12.8284 8.32843 13.5 7.5 13.5Z"/>
                                    <path d="M12 13.5C11.1716 13.5 10.5 12.8284 10.5 12C10.5 11.1716 11.1716 10.5 12 10.5C12.8284 10.5 13.5 11.1716 13.5 12C13.5 12.8284 12.8284 13.5 12 13.5Z"/>
                                    <path d="M16.5 13.5C15.6716 13.5 15 12.8284 15 12C15 11.1716 15.6716 10.5 16.5 10.5C17.3284 10.5 18 11.1716 18 12C18 12.8284 17.3284 13.5 16.5 13.5Z"/>
                                </svg>
                            </button>
                            <div class="more-menu-dropdown" id="moreMenuDropdown">
                                <button class="more-menu-item">Add AI label</button>
                                <button class="more-menu-item">Mark as paid partnership</button>
                                <div class="more-menu-divider"></div>
                                <button class="more-menu-item">
                                    <span>Schedule...</span>
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"/>
                                        <polyline points="12 6 12 12 16 14"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="create-post-body">
                    <div class="create-post-user">
                        <img src="" alt="avatar" class="create-post-avatar" id="createPostAvatar">
                        <div class="create-post-line"></div>
                    </div>
                    <div class="create-post-content">
                        <div class="create-post-user-row">
                            <span class="create-post-username" id="createPostUsername"></span>
                        </div>
                        <textarea class="create-post-textarea" id="createPostText" placeholder="What's new?"></textarea>
                        <div class="create-post-actions">
                            <label class="action-icon-btn" title="Add image">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <polyline points="21 15 16 10 5 21"/>
                                </svg>
                                <input type="file" accept="image/*" id="createPostImage" style="display: none;">
                            </label>
                            <button class="action-icon-btn" title="Add GIF">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="4" width="20" height="16" rx="2"/>
                                    <text x="6" y="15" font-size="8" fill="currentColor" stroke="none" font-weight="bold">GIF</text>
                                </svg>
                            </button>
                            <button class="action-icon-btn" title="Add hashtag">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="4" y1="9" x2="20" y2="9"/>
                                    <line x1="4" y1="15" x2="20" y2="15"/>
                                    <line x1="10" y1="3" x2="8" y2="21"/>
                                    <line x1="16" y1="3" x2="14" y2="21"/>
                                </svg>
                            </button>
                            <button class="action-icon-btn" title="Add poll">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <line x1="7" y1="8" x2="17" y2="8"/>
                                    <line x1="7" y1="12" x2="14" y2="12"/>
                                    <line x1="7" y1="16" x2="11" y2="16"/>
                                </svg>
                            </button>
                            <button class="action-icon-btn" title="Add location">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                    <circle cx="12" cy="10" r="3"/>
                                </svg>
                            </button>
                        </div>
                        <div class="create-post-image-preview" id="createPostImagePreview" style="display: none;"></div>
                    </div>
                </div>
                <div class="create-post-add-thread">
                    <img src="" alt="avatar" class="create-post-avatar-small" id="createPostAvatarSmall">
                    <span class="add-thread-text">Add to thread</span>
                </div>
                <div class="create-post-footer">
                    <span class="reply-options-text">Anyone can reply</span>
                    <button class="post-btn" id="postBtn" disabled>Post</button>
                </div>
            </div>
            <!-- Drafts view (inside same modal) -->
            <div class="drafts-view" id="draftsView" style="display: none;">
                <div class="drafts-header">
                    <button class="drafts-back-btn" id="draftsBackBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5"/>
                            <polyline points="12 19 5 12 12 5"/>
                        </svg>
                    </button>
                    <h2>Drafts</h2>
                    <div class="drafts-header-spacer"></div>
                </div>
                <div class="drafts-content">
                    <div class="drafts-empty">
                        <svg width="80" height="80" viewBox="0 0 24 24" fill="currentColor" class="drafts-empty-icon">
                            <rect height="15" rx="4.5" stroke="currentColor" stroke-width="1.5" width="15" x="7" y="7" fill="none"/>
                            <path clip-rule="evenodd" d="M15.3833 4.50007C15.0018 4.15977 14.5475 3.9045 14.05 3.75672C13.7983 3.68195 13.432 3.6357 12.7078 3.68313C11.9633 3.73189 11.0102 3.86454 9.59538 4.06338C8.18054 4.26222 7.22784 4.39741 6.4987 4.55577C5.78946 4.7098 5.45011 4.85522 5.22879 4.99646C4.51904 5.44941 3.99637 6.14302 3.7566 6.95012C3.68183 7.2018 3.63558 7.56809 3.68301 8.29232C3.73177 9.03686 3.86442 9.98992 4.06326 11.4047C4.23845 12.6513 4.36423 13.5391 4.49997 14.2313V17.5001C4.49997 17.737 4.51175 17.9713 4.53475 18.2022C4.05772 17.8249 3.64282 17.3681 3.31041 16.8473C2.66675 15.8387 2.47208 14.4535 2.08272 11.6831C1.69337 8.91269 1.49869 7.52748 1.83941 6.38057C2.21619 5.11227 3.03754 4.02231 4.15285 3.31053C5.16142 2.66688 6.54662 2.4722 9.31703 2.08284C12.0874 1.69349 13.4726 1.49881 14.6196 1.83953C15.8878 2.21631 16.9778 3.03766 17.6896 4.15297C17.7623 4.26696 17.8294 4.38577 17.8916 4.51084C17.7619 4.50369 17.6314 4.50007 17.5 4.50007H15.3833Z" fill-rule="evenodd"/>
                            <rect height="2" rx="1" width="9" x="10" y="12"/>
                            <rect height="2" rx="1" width="6" x="10" y="15"/>
                        </svg>
                        <p class="drafts-empty-title">No drafts yet</p>
                        <p class="drafts-empty-text">Your drafts will appear here.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // load saved theme
        let raw = localStorage.getItem('threads_theme');
        let savedTheme = 'auto';
        if (raw) {
            savedTheme = JSON.parse(raw);
        }
        if (savedTheme == 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
        } else if (savedTheme == 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
        } else {
            if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
            }
        }

        // Check login
        let isLoggedIn = localStorage.getItem('threads_is_logged_in') == 'true';
        if (!isLoggedIn) {
            window.location.href = 'login.html';
        }

        // Get current user
        let currentUser = null;
        try {
            currentUser = JSON.parse(localStorage.getItem('threads_user'));
        } catch(e) {}

        // Modal elements
        let modalOverlay = document.getElementById('modalOverlay');
        let createPostClose = document.getElementById('createPostClose');
        let createPostText = document.getElementById('createPostText');
        let postBtn = document.getElementById('postBtn');
        let createPostAvatar = document.getElementById('createPostAvatar');
        let createPostAvatarSmall = document.getElementById('createPostAvatarSmall');
        let createPostUsername = document.getElementById('createPostUsername');
        let fab = document.getElementById('fab');

        function openModal() {
            if (modalOverlay && currentUser) {
                if (createPostAvatar && currentUser.avatar) {
                    createPostAvatar.src = currentUser.avatar;
                }
                if (createPostAvatarSmall && currentUser.avatar) {
                    createPostAvatarSmall.src = currentUser.avatar;
                }
                if (createPostUsername && currentUser.username) {
                    createPostUsername.textContent = currentUser.username;
                }
                modalOverlay.classList.add('active');
            }
        }

        function closeModal() {
            if (modalOverlay) {
                modalOverlay.classList.remove('active');
                modalOverlay.classList.remove('from-fab');
                if (createPostText) createPostText.value = '';
                if (postBtn) postBtn.disabled = true;
            }
            // clear image preview
            let preview = document.getElementById('createPostImagePreview');
            if (preview) {
                preview.innerHTML = '';
                preview.style.display = 'none';
            }
            let fileInput = document.getElementById('createPostImage');
            if (fileInput) fileInput.value = '';
            if (fab) fab.style.display = '';
        }

        if (createPostClose) {
            createPostClose.onclick = closeModal;
        }

        if (modalOverlay) {
            modalOverlay.addEventListener('click', function(e) {
                if (e.target == modalOverlay) closeModal();
            });
        }

        // check if modal has text or images
        function checkPostBtn() {
            let hasText = createPostText && createPostText.value.trim().length > 0;
            let preview = document.getElementById('createPostImagePreview');
            let hasImages = preview && preview.querySelectorAll('.create-post-image-item').length > 0;
            if (postBtn) {
                if (hasText || hasImages) {
                    postBtn.disabled = false;
                } else {
                    postBtn.disabled = true;
                }
            }
        }

        if (createPostText) {
            createPostText.addEventListener('input', function() {
                checkPostBtn();
            });
        }

        // image upload
        let createPostImage = document.getElementById('createPostImage');
        if (createPostImage) {
            createPostImage.onchange = function(e) {
                let files = e.target.files;
                if (!files || files.length == 0) return;
                let preview = document.getElementById('createPostImagePreview');
                if (!preview) return;
                preview.style.display = 'flex';

                for (let f = 0; f < files.length; f++) {
                    (function(file) {
                        let reader = new FileReader();
                        reader.onload = function(ev) {
                            let item = document.createElement('div');
                            item.className = 'create-post-image-item';

                            let img = document.createElement('img');
                            img.src = ev.target.result;
                            img.alt = 'preview';
                            item.appendChild(img);

                            // remove button
                            let removeBtn = document.createElement('button');
                            removeBtn.className = 'remove-image-btn';
                            removeBtn.innerHTML = '&times;';
                            removeBtn.onclick = function() {
                                item.remove();
                                if (preview.children.length == 0) {
                                    preview.style.display = 'none';
                                }
                                checkPostBtn();
                            };
                            item.appendChild(removeBtn);
                            preview.appendChild(item);
                            checkPostBtn();
                        };
                        reader.readAsDataURL(file);
                    })(files[f]);
                }
                // reset so same file can be picked again
                createPostImage.value = '';
            };
        }

        if (postBtn) {
            postBtn.onclick = function() {
                if (!currentUser) return;

                let text = '';
                if (createPostText) {
                    text = createPostText.value.trim();
                }

                // get images from preview
                let images = [];
                let preview = document.getElementById('createPostImagePreview');
                if (preview) {
                    let imgElements = preview.querySelectorAll('.create-post-image-item img');
                    for (let i = 0; i < imgElements.length; i++) {
                        if (imgElements[i].src && imgElements[i].src != '') {
                            images.push(imgElements[i].src);
                        }
                    }
                }

                // need at least text or image
                if (text.length == 0 && images.length == 0) return;

                // get existing posts from localstorage
                let posts = [];
                try {
                    let data = localStorage.getItem('threads_user_posts');
                    if (data) {
                        posts = JSON.parse(data);
                    }
                    if (!posts) {
                        posts = [];
                    }
                } catch(e) {
                    posts = [];
                }

                // add new post to the top
                let newPost = {
                    username: currentUser.username,
                    avatar: currentUser.avatar,
                    text: text,
                    time: 'now',
                    likes: 0,
                    comments: 0
                };

                // add images if we have any
                if (images.length > 0) {
                    newPost.images = images;
                }

                posts.unshift(newPost);

                // save back to localstorage
                localStorage.setItem('threads_user_posts', JSON.stringify(posts));
                closeModal();
            };
        }

        // FAB click
        if (fab) {
            fab.onclick = function() {
                if (modalOverlay) modalOverlay.classList.add('from-fab');
                fab.style.display = 'none';
                openModal();
            };
        }

        // Drafts view toggle
        let draftsBtn = document.getElementById('draftsBtn');
        let draftsView = document.getElementById('draftsView');
        let draftsBackBtn = document.getElementById('draftsBackBtn');
        let createPostForm = document.getElementById('createPostForm');
        if (draftsBtn && draftsView && createPostForm) {
            draftsBtn.onclick = function(e) {
                e.stopPropagation();
                createPostForm.style.display = 'none';
                draftsView.style.display = 'flex';
            };
            if (draftsBackBtn) {
                draftsBackBtn.onclick = function(e) {
                    e.stopPropagation();
                    draftsView.style.display = 'none';
                    createPostForm.style.display = '';
                };
            }
        }

        // More menu dropdown
        let moreMenuBtn = document.getElementById('moreMenuBtn');
        let moreMenuDropdown = document.getElementById('moreMenuDropdown');
        if (moreMenuBtn && moreMenuDropdown) {
            moreMenuBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                moreMenuDropdown.classList.toggle('active');
            });
            document.addEventListener('click', function(e) {
                if (!moreMenuDropdown.contains(e.target) && !moreMenuBtn.contains(e.target)) {
                    moreMenuDropdown.classList.remove('active');
                }
            });
        }

        // Mobile menu dropdown
        let mobileMenuBtn = document.getElementById('mobileMenuBtn');
        let mobileMenuDropdown = document.getElementById('mobileMenuDropdown');
        if (mobileMenuBtn && mobileMenuDropdown) {
            mobileMenuBtn.onclick = function(e) {
                e.stopPropagation();
                if (mobileMenuDropdown.classList.contains('active')) {
                    mobileMenuDropdown.classList.remove('active');
                } else {
                    let main = document.getElementById('mobileMenuMain');
                    let appSub = document.getElementById('mobileAppearanceSubmenu');
                    let feedsSub = document.getElementById('mobileFeedsSubmenu');
                    if (main) main.style.display = 'block';
                    if (appSub) appSub.classList.remove('active');
                    if (feedsSub) feedsSub.classList.remove('active');
                    mobileMenuDropdown.classList.add('active');
                }
            };
            document.addEventListener('click', function(e) {
                if (!mobileMenuDropdown.contains(e.target) && e.target != mobileMenuBtn) {
                    mobileMenuDropdown.classList.remove('active');
                }
            });

            // Appearance submenu
            let mobileAppearanceBtn = document.getElementById('mobileAppearanceBtn');
            let mobileAppearanceSubmenu = document.getElementById('mobileAppearanceSubmenu');
            let mobileMenuMain = document.getElementById('mobileMenuMain');
            if (mobileAppearanceBtn && mobileAppearanceSubmenu && mobileMenuMain) {
                mobileAppearanceBtn.onclick = function() {
                    mobileMenuMain.style.display = 'none';
                    mobileAppearanceSubmenu.classList.add('active');
                };
            }
            let mobileAppearanceBackBtn = document.getElementById('mobileAppearanceBackBtn');
            if (mobileAppearanceBackBtn && mobileAppearanceSubmenu && mobileMenuMain) {
                mobileAppearanceBackBtn.onclick = function() {
                    mobileAppearanceSubmenu.classList.remove('active');
                    mobileMenuMain.style.display = 'block';
                };
            }

            // Appearance options (theme toggle)
            let mobileAppearanceOptions = mobileMenuDropdown.querySelectorAll('.appearance-option');
            for (let i = 0; i < mobileAppearanceOptions.length; i++) {
                mobileAppearanceOptions[i].onclick = function() {
                    for (let j = 0; j < mobileAppearanceOptions.length; j++) {
                        mobileAppearanceOptions[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    let theme = this.getAttribute('data-theme');
                    if (theme == 'dark') {
                        document.documentElement.setAttribute('data-theme', 'dark');
                    } else if (theme == 'light') {
                        document.documentElement.setAttribute('data-theme', 'light');
                    } else {
                        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                            document.documentElement.setAttribute('data-theme', 'dark');
                        } else {
                            document.documentElement.setAttribute('data-theme', 'light');
                        }
                    }
                    localStorage.setItem('threads_theme', JSON.stringify(theme));
                };
            }

            // Feeds submenu
            let mobileFeedsBtn = document.getElementById('mobileFeedsBtn');
            let mobileFeedsSubmenu = document.getElementById('mobileFeedsSubmenu');
            if (mobileFeedsBtn && mobileFeedsSubmenu && mobileMenuMain) {
                mobileFeedsBtn.onclick = function() {
                    mobileMenuMain.style.display = 'none';
                    mobileFeedsSubmenu.classList.add('active');
                };
            }
            let mobileFeedsBackBtn = document.getElementById('mobileFeedsBackBtn');
            if (mobileFeedsBackBtn && mobileFeedsSubmenu && mobileMenuMain) {
                mobileFeedsBackBtn.onclick = function() {
                    mobileFeedsSubmenu.classList.remove('active');
                    mobileMenuMain.style.display = 'block';
                };
            }

            // Logout
            let mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
            if (mobileLogoutBtn) {
                mobileLogoutBtn.onclick = function() {
                    localStorage.removeItem('threads_is_logged_in');
                    localStorage.removeItem('threads_user');
                    window.location.href = 'login.html';
                };
            }
        }

        // Date range dropdown
        let dateRangeBtn = document.getElementById('dateRangeBtn');
        let dateRangeDropdown = document.getElementById('dateRangeDropdown');
        let dateRangeItems = document.querySelectorAll('.date-range-item');
        let insightsHeaderDate = document.getElementById('insightsHeaderDate');

        function updateDateRange(days) {
            let endDate = new Date();
            let startDate = new Date();
            startDate.setDate(endDate.getDate() - parseInt(days));
            let options = { day: 'numeric', month: 'short' };
            let startStr = startDate.toLocaleDateString('en-GB', options);
            let endStr = endDate.toLocaleDateString('en-GB', options);
            if (insightsHeaderDate) {
                insightsHeaderDate.textContent = startStr + ' \u2013 ' + endStr;
            }
        }

        // Set initial date range (30 days default)
        updateDateRange(30);

        if (dateRangeBtn && dateRangeDropdown) {
            dateRangeBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                dateRangeDropdown.classList.toggle('active');
            });
            document.addEventListener('click', function(e) {
                if (!dateRangeDropdown.contains(e.target) && !dateRangeBtn.contains(e.target)) {
                    dateRangeDropdown.classList.remove('active');
                }
            });
        }

        // Date range selection
        for (let i = 0; i < dateRangeItems.length; i++) {
            dateRangeItems[i].addEventListener('click', function() {
                for (let j = 0; j < dateRangeItems.length; j++) {
                    dateRangeItems[j].classList.remove('active');
                }
                this.classList.add('active');
                updateDateRange(this.getAttribute('data-days'));
                dateRangeDropdown.classList.remove('active');
            });
        }

        // Insights menu dropdown
        let insightsMenuBtn = document.getElementById('insightsMenuBtn');
        let insightsDropdown = document.getElementById('insightsDropdown');
        if (insightsMenuBtn && insightsDropdown) {
            insightsMenuBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                insightsDropdown.classList.toggle('active');
            });
            document.addEventListener('click', function(e) {
                if (!insightsDropdown.contains(e.target) && !insightsMenuBtn.contains(e.target)) {
                    insightsDropdown.classList.remove('active');
                }
            });
        }

        // Navigation
        let navBtns = document.querySelectorAll('.nav-btn[data-tab]');
        for (let i = 0; i < navBtns.length; i++) {
            let btn = navBtns[i];
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                let tab = this.getAttribute('data-tab');
                if (tab == 'home') {
                    window.location.href = 'home.html';
                } else if (tab == 'search') {
                    window.location.href = 'home.html#search';
                } else if (tab == 'create') {
                    window.location.href = 'home.html#create';
                } else if (tab == 'activity') {
                    window.location.href = 'activity.html';
                } else if (tab == 'profile') {
                    window.location.href = 'profile.html';
                }
            });
        }
    </script>
</body>
</html>
